<div class="opacity-0 animate-appear duration-500">
	<div class="bg-white dark:bg-secondary-dark-bg shadow-lg rounded-lg m-6">
		<div class="bg-gradient-to-r from-prime-blue to-hover-prime-blue text-white px-8 py-6 rounded-t-lg">
			<div class="flex items-center space-x-3">
				<iconify-icon icon="octicon:trophy-24" class="text-[2rem] mr-5"></iconify-icon>
				<div>
					<h1 class="text-2xl font-bold">Modification d'une compétition</h1>
					<p class="text-blue-100 mt-1">Modifiez les données des compétitions créées précédemment</p>
				</div>
			</div>
		</div>
		<div class="min-w-[525px] mx-auto shadow-lg">
			<p-table [value]="competitions" dataKey="id" [paginator]="true" [rows]="nbRowsPerPage">
				<ng-template pTemplate="header">
					<tr>
						<th pSortableColumn="name" class="!bg-gray-100 hover:dark:!bg-gray-700 hover:!bg-gray-200">
							<div class="flex items-center">
								<span class="text-prime-blue dark:text-gray-300 mr-2 whitespace-nowrap">Nom</span>
								<p-sortIcon field="name" class="ml-1 mt-[6px] text-gray-500 dark:text-gray-400" />
								<p-columnFilter type="text" field="name" display="menu" class="ml-1"></p-columnFilter>
							</div>
						</th>
						<th pSortableColumn="startDate" class="!bg-gray-100 hover:dark:!bg-gray-700 hover:!bg-gray-200">
							<div class="flex items-center">
								<span class="text-prime-blue dark:text-gray-300 mr-2 whitespace-nowrap">Date de début</span>
								<p-sortIcon field="startDate" class="ml-1 mt-[6px] text-gray-500 dark:text-gray-400" />
								<p-columnFilter type="date" field="startDate" display="menu" class="ml-1"></p-columnFilter>
							</div>
						</th>
						<th pSortableColumn="endDate" class="!bg-gray-100 hover:dark:!bg-gray-700 hover:!bg-gray-200">
							<div class="flex items-center">
								<span class="text-prime-blue dark:text-gray-300 mr-2 whitespace-nowrap">Date de fin</span>
								<p-sortIcon field="endDate" class="ml-1 mt-[6px] text-gray-500 dark:text-gray-400" />
								<p-columnFilter type="date" field="endDate" display="menu" class="ml-1"></p-columnFilter>
							</div>
						</th>
						<th pSortableColumn="price" class="!bg-gray-100 hover:dark:!bg-gray-700 hover:!bg-gray-200">
							<div class="flex items-center">
								<span class="text-prime-blue dark:text-gray-300 mr-2 whitespace-nowrap">Prix (€)</span>
								<p-sortIcon field="price" class="ml-1 mt-[6px] text-gray-500 dark:text-gray-400" />
								<p-columnFilter type="numeric" field="price" display="menu" class="ml-1"></p-columnFilter>
							</div>
						</th>
						<th pSortableColumn="supCategoryPrice" class="!bg-gray-100 hover:dark:!bg-gray-700 hover:!bg-gray-200">
							<div class="flex items-center">
								<span class="text-prime-blue dark:text-gray-300 mr-2 whitespace-nowrap">Prix catégorie sup. (€)</span>
								<p-sortIcon field="supCategoryPrice" class="ml-1 mt-[6px] text-gray-500 dark:text-gray-400" />
								<p-columnFilter type="numeric" field="supCategoryPrice" display="menu" class="ml-1"></p-columnFilter>
							</div>
						</th>
						<th class="!bg-gray-100"></th>
						<th class="!bg-gray-100 min-w-[55px]"></th>
					</tr>
				</ng-template>

				<ng-template pTemplate="body" let-competition>
					<tr>
						<td class="!py-4 whitespace-nowrap">{{ competition.name }}</td>
						<td class="!py-4 whitespace-nowrap">{{ competition.startDate | date : "dd/MM/yyyy" }}</td>
						<td class="!py-4 whitespace-nowrap">{{ competition.endDate | date : "dd/MM/yyyy" }}</td>
						<td class="!py-4 whitespace-nowrap">{{ competition.price | currency : "EUR" : "symbol" : "1.0-0" : "fr-FR" }}</td>
						<td class="!py-4 whitespace-nowrap">{{ competition.supCategoryPrice | currency : "EUR" : "symbol" : "1.0-0" : "fr-FR" }}</td>
						<td class="relative !py-4">
							<div
								class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 p-1.5 pb-0 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 cursor-pointer"
							(click)="goToEditCompetition(competition)">
								<iconify-icon icon="lucide:pen-line" class="text-[1.2rem]"></iconify-icon>
							</div>
						</td>
						<td class="relative !py-4">
							<div
								class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 p-1.5 pb-0 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 cursor-pointer"
								(click)="confirmDeletion(competition)"
							>
								<iconify-icon icon="formkit:trash" class="text-[1.2rem]"></iconify-icon>
							</div>
						</td>
					</tr>
				</ng-template>

				<ng-template pTemplate="emptymessage">
					@if (isFetchingData) {
					<tr>
						<td colspan="7">
							<div class="flex items-center justify-center py-3" aria-live="polite">
                                <iconify-icon icon="line-md:loading-loop" class="text-[1.2rem] text-gray-500 dark:text-gray-400"></iconify-icon>
								<span class="ml-3 text-gray-500 dark:text-gray-400">Chargement des données…</span>
							</div>
						</td>
					</tr>
					} @else {
					<tr>
						<td colspan="7" class="py-6 text-center text-gray-500 dark:text-gray-400">Aucune donnée trouvée.</td>
					</tr>
					}
				</ng-template>
			</p-table>
		</div>
	</div>
</div>

<!-- Div affichée lors d'un click sur icon de modification, afin d'afficher le nouveau formulaire -->
<dialog id="displayModifFormModal" class="dui-modal">
	<div class="dui-modal-box w-fit max-w-5xl text-gray-800 dark:text-gray-300 bg-white dark:bg-secondary-dark-bg"></div>
	<form method="dialog" class="dui-modal-backdrop">
		<button class="outline-none border-none bg-transparent"></button>
	</form>
</dialog>
